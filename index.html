<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Two Free</title>
    <!-- Favicon Generator -->
    <link rel="icon" href="#" id="favicon">
    <script>
        // Generate favicon from robot design
        document.addEventListener('DOMContentLoaded', function() {
            // Create a small canvas for the favicon
            const faviconCanvas = document.createElement('canvas');
            faviconCanvas.width = 32;
            faviconCanvas.height = 32;
            const ctx = faviconCanvas.getContext('2d');
            
            // Draw robot head (simplified version of the game robot)
            // Background
            ctx.fillStyle = '#3a5d7c';
            ctx.fillRect(0, 0, 32, 32);
            
            // Body
            ctx.fillStyle = '#E8A30C'; // Wall-E yellow
            ctx.fillRect(4, 10, 24, 20);
            
            // Head
            ctx.fillStyle = '#E8A30C';
            ctx.fillRect(6, 3, 20, 10);
            
            // Eyes
            ctx.fillStyle = '#333';
            ctx.fillRect(16, 5, 8, 6);
            
            // Eye detail
            ctx.fillStyle = '#66CCFF'; // Blue eyes
            ctx.fillRect(18, 6, 4, 4);
            
            // Eyebrow
            ctx.fillStyle = '#333';
            ctx.fillRect(16, 3, 8, 2);
            
            // Treads
            ctx.fillStyle = '#333333';
            ctx.fillRect(2, 24, 28, 6);
            
            // Digging arm
            ctx.fillStyle = '#555';
            ctx.beginPath();
            ctx.moveTo(28, 14);
            ctx.lineTo(32, 12);
            ctx.lineTo(32, 20);
            ctx.lineTo(28, 18);
            ctx.closePath();
            ctx.fill();
            
            // Set the favicon
            const favicon = document.getElementById('favicon');
            favicon.href = faviconCanvas.toDataURL('image/png');
        });
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
        
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(to bottom, #041e42, #0a3a6a);
            font-family: 'Orbitron', sans-serif;
            touch-action: none;
            color: white;
        }
        
        #game-wrapper {
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 0 40px rgba(0, 100, 255, 0.4);
            border: 2px solid #4a6d8c;
        }
        
        canvas {
            display: block;
            max-width: 100%;
            max-height: 80vh;
        }
        
        /* Fix canvas size for mobile */
        @media (max-width: 800px) or (pointer: coarse) {
            canvas {
                max-height: 65vh; /* Allow more space for controls */
            }
        }
        
        #game-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        /* Add space for controls below canvas */
        @media (max-width: 800px) or (pointer: coarse) {
            #game-container {
                padding-bottom: 120px; /* Space for controls - reduced from 180px */
            }
            
            /* Adjust for portrait mode */
            @media (orientation: portrait) {
                canvas {
                    max-height: 60vh;
                }
                
                #game-container {
                    padding-bottom: 150px;
                }
            }
        }
        
        #title-bar {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 20, 40, 0.7);
            padding: 5px 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }
        
        .game-title {
            font-size: 24px;
            color: #66CCFF;
            text-shadow: 0 0 10px rgba(102, 204, 255, 0.7);
            margin: 0;
        }
        
        #ui {
            position: absolute;
            top: 50px;
            left: 15px;
            color: white;
            font-size: 18px;
            text-shadow: 1px 1px 2px black;
            display: flex;
            flex-direction: column;
            gap: 5px;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 10px;
            border: 1px solid rgba(102, 204, 255, 0.5);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .stat-item {
            display: flex;
            align-items: center;
        }
        
        .stat-icon {
            width: 20px;
            height: 20px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            background: rgba(102, 204, 255, 0.3);
            margin-right: 8px;
            border-radius: 4px;
        }
        
        #level-complete {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 20, 40, 0.9);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            display: none;
            z-index: 1000;
            width: 80%;
            max-width: 400px;
            box-shadow: 0 0 30px rgba(102, 204, 255, 0.7);
            border: 2px solid #66CCFF;
        }
        
        #level-complete h2 {
            margin-top: 0;
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
        }
        
        #level-complete p {
            margin: 15px 0;
        }
        
        .highlight {
            color: #66CCFF;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        #touch-controls {
            display: none;
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
        }
        
        .control-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .control-btn {
            background: rgba(102, 204, 255, 0.3);
            border: 2px solid #66CCFF;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            user-select: none;
            color: white;
            box-shadow: 0 0 10px rgba(102, 204, 255, 0.5);
            transition: all 0.2s;
        }
        
        .control-btn:active {
            background: rgba(102, 204, 255, 0.6);
            transform: scale(0.95);
        }
        
        .control-btn.large {
            width: 80px;
            height: 80px;
        }
        
        #pauseBtn {
            transition: all 0.2s;
            box-shadow: 0 0 10px rgba(102, 204, 255, 0.5);
        }
        
        #pauseBtn:hover {
            background: rgba(102, 204, 255, 0.5);
            transform: scale(1.05);
        }
        
        #pauseBtn:active {
            background: rgba(102, 204, 255, 0.6);
            transform: scale(0.95);
        }
        
        @media (max-width: 800px) or (pointer: coarse) {
            #touch-controls {
                position: fixed;
                bottom: 10px;
                left: 0;
                right: 0;
                display: flex;
                flex-direction: column;
                gap: 10px;
                padding: 10px 20px 20px 20px;
                z-index: 1000;
                background: rgba(0, 10, 20, 0.8);
                border-top: 2px solid rgba(102, 204, 255, 0.5);
                box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.5);
            }
            
            .control-row {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 0;
                width: 100%;
                max-width: 500px;
                margin: 0 auto;
            }
            
            .control-row:first-child {
                justify-content: center;
                margin-bottom: 5px;
            }
            
            .control-btn {
                width: 70px;
                height: 70px;
                font-size: 30px;
                background: rgba(102, 204, 255, 0.5);
                border: 3px solid #66CCFF;
                box-shadow: 0 0 15px rgba(102, 204, 255, 0.7);
                position: relative;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                -webkit-tap-highlight-color: transparent;
                user-select: none;
                touch-action: manipulation;
            }
            
            .control-btn::after {
                content: '';
                position: absolute;
                top: -10px;
                left: -10px;
                right: -10px;
                bottom: -10px;
                z-index: -1;
            }
            
            .btn-icon {
                font-size: 34px;
                line-height: 1;
                font-weight: bold;
                text-shadow: 0 0 5px rgba(0, 0, 0, 0.7);
            }
            
            .btn-label {
                font-size: 13px;
                margin-top: 4px;
                font-weight: bold;
                text-shadow: 0 0 5px rgba(0, 0, 0, 0.7);
                letter-spacing: 0.5px;
            }
            
            .control-btn:active {
                background: rgba(102, 204, 255, 0.8);
                transform: scale(0.95);
                box-shadow: 0 0 25px rgba(102, 204, 255, 0.9);
            }
            
            .control-btn.large {
                width: 90px;
                height: 90px;
            }
            
            .control-btn.dig-btn {
                background: rgba(255, 160, 0, 0.5);
                border-color: #FFA000;
            }
            
            .control-btn.dig-btn:active {
                background: rgba(255, 160, 0, 0.8);
                box-shadow: 0 0 25px rgba(255, 160, 0, 0.9);
            }
            
            #leftBtn, #rightBtn, #leftBtn-alt, #rightBtn-alt, #leftBtn-left, #rightBtn-left {
                position: relative;
            }
            
            #leftBtn::before, #rightBtn::before, 
            #leftBtn-alt::before, #rightBtn-alt::before,
            #leftBtn-left::before, #rightBtn-left::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 10, 20, 0.4);
                border-radius: 50%;
                z-index: -1;
            }
            
            #tablet-layout {
                display: flex;
                justify-content: space-between;
                width: 100%;
                max-width: 500px;
                margin: 0 auto;
            }
            
            .tablet-controls-left, .tablet-controls-right {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                width: 40%;
            }
            
            @media (prefers-contrast: more) {
                .control-btn {
                    background: rgba(102, 204, 255, 0.9);
                    border-width: 4px;
                }
                
                .control-btn.dig-btn {
                    background: rgba(255, 160, 0, 0.9);
                }
                
                .btn-label, .btn-icon {
                    text-shadow: 0 0 8px black;
                }
            }
            
            @media (orientation: portrait) {
                #touch-controls {
                    bottom: 40px;
                }
                
                .control-btn {
                    width: 80px;
                    height: 80px;
                }
                
                .control-btn.large {
                    width: 100px;
                    height: 100px;
                }
                
                .btn-icon {
                    font-size: 36px;
                }
                
                .btn-label {
                    font-size: 14px;
                    margin-top: 5px;
                }
            }
            
            @media (max-width: 400px) {
                .control-btn {
                    width: 65px;
                    height: 65px;
                }
                
                .control-btn.large {
                    width: 80px;
                    height: 80px;
                }
                
                .btn-icon {
                    font-size: 30px;
                }
            }
            
            /* Improved pause button for mobile */
            #pauseBtn {
                width: 60px;
                height: 60px;
                font-size: 28px;
                top: 20px;
                right: 20px;
                background: rgba(102, 204, 255, 0.5);
                border: 3px solid #66CCFF;
                box-shadow: 0 0 20px rgba(102, 204, 255, 0.6);
            }
            
            #pauseBtn:active {
                transform: scale(0.95);
                background: rgba(102, 204, 255, 0.7);
            }
        }
        
        @keyframes twinkle {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }
        
        /* Add better centering for tablet */
        @media (min-width: 600px) and (max-width: 1024px) {
            body {
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
                padding: 0;
                margin: 0;
            }
            
            #game-wrapper {
                max-width: 90%;
                margin: 0 auto;
            }
            
            canvas {
                max-height: 70vh;
                margin: 0 auto;
            }
            
            #game-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                padding-bottom: 120px; /* Space for controls */
            }
            
            #touch-controls {
                width: 100%;
                max-width: 600px;
                margin: 0 auto;
            }
            
            /* Improve tablet layout spacing */
            #tablet-layout {
                padding: 0 10%;
            }
            
            .control-btn {
                width: 85px;
                height: 85px;
            }
            
            .control-btn.large {
                width: 100px;
                height: 100px;
            }
            
            .btn-icon {
                font-size: 36px;
            }
            
            .btn-label {
                font-size: 16px;
                margin-top: 5px;
            }
        }
    </style>
</head>
<body>
    <div id="game-wrapper">
        <div id="title-bar">
            <h1 class="game-title">TWO FREE</h1>
        </div>
        
        <!-- Entry screen overlay -->
        <div id="entry-screen" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 20, 40, 0.95); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 2000; text-align: center; padding: 20px; overflow: hidden;">
            <!-- Background animation -->
            <div style="position: absolute; width: 100%; height: 100%; overflow: hidden; opacity: 0.2; z-index: -1;">
                <div id="bg-stars" style="position: absolute; top: 0; left: 0; width: 200%; height: 200%;"></div>
            </div>
            
            <h1 style="color: #66CCFF; text-shadow: 0 0 20px rgba(102, 204, 255, 0.7); font-size: 48px; margin-bottom: 20px;">TWO FREE</h1>
            
            <div style="background: rgba(0, 10, 20, 0.8); padding: 20px; border-radius: 15px; max-width: 80%; margin: 0 auto; border: 2px solid #66CCFF; box-shadow: 0 0 30px rgba(102, 204, 255, 0.3);">
                <p style="color: #fff; margin-bottom: 20px; line-height: 1.5;">In a world torn apart by war, you are one of the two remaining free robots. Your mission is to collect precious energy diamonds deep underground while avoiding deadly missile strikes from above.</p>
                
                <div style="display: flex; justify-content: space-around; margin: 20px 0;">
                    <div style="text-align: center;">
                        <div style="color: #fff; margin-bottom: 10px;">Movement</div>
                        <div style="display: flex; gap: 5px;">
                            <div style="background: rgba(102, 204, 255, 0.3); border: 1px solid #66CCFF; padding: 5px 12px; border-radius: 4px;">↑</div>
                            <div style="background: rgba(102, 204, 255, 0.3); border: 1px solid #66CCFF; padding: 5px 12px; border-radius: 4px;">←</div>
                            <div style="background: rgba(102, 204, 255, 0.3); border: 1px solid #66CCFF; padding: 5px 12px; border-radius: 4px;">↓</div>
                            <div style="background: rgba(102, 204, 255, 0.3); border: 1px solid #66CCFF; padding: 5px 12px; border-radius: 4px;">→</div>
                        </div>
                    </div>
                    
                    <div style="text-align: center;">
                        <div style="color: #fff; margin-bottom: 10px;">Dig (Down Arrow)</div>
                        <div style="background: rgba(102, 204, 255, 0.3); border: 1px solid #66CCFF; padding: 5px 12px; border-radius: 4px;">↓</div>
                    </div>
                </div>
                
                <p style="color: #fff; margin: 20px 0; line-height: 1.5;">Hide underground to escape missile attacks. Collect all diamonds to advance to the next level.</p>
            </div>
            
            <button id="start-game-btn" style="margin-top: 30px; background: rgba(102, 204, 255, 0.3); color: white; border: 2px solid #66CCFF; padding: 15px 40px; font-size: 24px; border-radius: 50px; cursor: pointer; font-family: 'Orbitron', sans-serif; box-shadow: 0 0 20px rgba(102, 204, 255, 0.5); transition: all 0.3s ease;">START MISSION</button>
        </div>
        
        <div id="game-container">
            <canvas id="gameCanvas" width="800" height="600"></canvas>
            
            <div id="ui">
                <div class="stat-item">
                    <div class="stat-icon">⚡</div>
                    <div>Energy: <span id="energyDisplay">0</span></div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon">🏆</div>
                    <div>Level: <span id="levelDisplay">1</span></div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon">💎</div>
                    <div>Diamonds: <span id="diamondDisplay"></span></div>
                </div>
            </div>
            
            <div id="level-complete">
                <h2>Level Complete!</h2>
                <p>You collected all treasures!</p>
                <p>Level bonus: <span id="levelBonus" class="highlight">0</span></p>
                <p>Total diamonds: <span id="totalDiamonds" class="highlight">0</span></p>
                <p>Next level starting in <span id="countdown" class="highlight">3</span>...</p>
            </div>
            
            <!-- Game Over screen -->
            <div id="game-over" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(139, 0, 0, 0.9); color: white; padding: 30px; border-radius: 15px; text-align: center; display: none; z-index: 1000; width: 80%; max-width: 400px; box-shadow: 0 0 30px rgba(255, 0, 0, 0.7); border: 2px solid #ff0000;">
                <h2 style="color: #ff3333; text-shadow: 0 0 10px rgba(255, 0, 0, 0.7); margin-top: 0;">GAME OVER</h2>
                <p>Your robot was destroyed by enemy forces!</p>
                <p>Diamonds collected: <span id="finalDiamonds" class="highlight">0</span></p>
                <p>Levels completed: <span id="levelsCompleted" class="highlight">0</span></p>
                <button id="restart-game-btn" style="margin-top: 20px; background: rgba(255, 0, 0, 0.3); color: white; border: 2px solid #ff3333; padding: 15px 40px; font-size: 20px; border-radius: 50px; cursor: pointer; font-family: 'Orbitron', sans-serif; box-shadow: 0 0 20px rgba(255, 0, 0, 0.5); transition: all 0.3s ease;">RESTART MISSION</button>
            </div>
            
            <!-- Achievement notification area -->
            <div id="achievements" style="position: absolute; top: 60px; left: 0; right: 0; display: flex; flex-direction: column; align-items: center; gap: 10px; z-index: 1000;"></div>
            
            <!-- Pause button that's always visible -->
            <div id="pauseBtn" role="button" aria-label="Pause game" tabindex="0" style="position: absolute; top: 15px; right: 15px; background: rgba(102, 204, 255, 0.4); border: 2px solid #66CCFF; border-radius: 50%; width: 50px; height: 50px; display: flex; justify-content: center; align-items: center; font-size: 24px; color: white; cursor: pointer; z-index: 100; box-shadow: 0 0 15px rgba(102, 204, 255, 0.5); -webkit-tap-highlight-color: transparent;">⏸️</div>
            
            <!-- Sound toggle button -->
            <div id="soundBtn" role="button" aria-label="Toggle sound" tabindex="0" style="position: absolute; top: 15px; right: 75px; background: rgba(102, 204, 255, 0.4); border: 2px solid #66CCFF; border-radius: 50%; width: 50px; height: 50px; display: flex; justify-content: center; align-items: center; font-size: 24px; color: white; cursor: pointer; z-index: 100; box-shadow: 0 0 15px rgba(102, 204, 255, 0.5); -webkit-tap-highlight-color: transparent;">🔊</div>
            
            <div id="touch-controls" role="group" aria-label="Game controls">
                <!-- Standard layout (default) -->
                <div id="standard-layout" role="group" aria-label="Standard control layout">
                    <div class="control-row">
                        <div id="jumpBtn" class="control-btn large" role="button" aria-label="Jump">
                            <span class="btn-icon">↑</span>
                            <span class="btn-label">JUMP</span>
                        </div>
                    </div>
                    <div class="control-row">
                        <div id="leftBtn" class="control-btn" role="button" aria-label="Move left">
                            <span class="btn-icon">←</span>
                        </div>
                        <div id="rightBtn" class="control-btn" role="button" aria-label="Move right">
                            <span class="btn-icon">→</span>
                        </div>
                        <div id="digBtn" class="control-btn dig-btn" role="button" aria-label="Dig">
                            <span class="btn-icon">↓</span>
                            <span class="btn-label">DIG</span>
                        </div>
                    </div>
                </div>
                
                <!-- Tablet layout (hidden by default) -->
                <div id="tablet-layout" role="group" aria-label="Tablet control layout" style="display: none;">
                    <div class="tablet-controls-left">
                        <div id="jumpBtn-alt" class="control-btn large" role="button" aria-label="Jump">
                            <span class="btn-icon">↑</span>
                            <span class="btn-label">JUMP</span>
                        </div>
                        <div style="margin-top: 15px;">
                            <div id="leftBtn-alt" class="control-btn" role="button" aria-label="Move left">
                                <span class="btn-icon">←</span>
                            </div>
                        </div>
                    </div>
                    <div class="tablet-controls-right">
                        <div id="digBtn-alt" class="control-btn dig-btn large" role="button" aria-label="Dig">
                            <span class="btn-icon">↓</span>
                            <span class="btn-label">DIG</span>
                        </div>
                        <div style="margin-top: 15px;">
                            <div id="rightBtn-alt" class="control-btn" role="button" aria-label="Move right">
                                <span class="btn-icon">→</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Left-handed layout (hidden by default) -->
                <div id="lefty-layout" role="group" aria-label="Left-handed control layout" style="display: none;">
                    <div class="control-row">
                        <div id="jumpBtn-left" class="control-btn large" role="button" aria-label="Jump">
                            <span class="btn-icon">↑</span>
                            <span class="btn-label">JUMP</span>
                        </div>
                    </div>
                    <div class="control-row">
                        <div id="digBtn-left" class="control-btn dig-btn" role="button" aria-label="Dig">
                            <span class="btn-icon">↓</span>
                            <span class="btn-label">DIG</span>
                        </div>
                        <div id="leftBtn-left" class="control-btn" role="button" aria-label="Move left">
                            <span class="btn-icon">←</span>
                        </div>
                        <div id="rightBtn-left" class="control-btn" role="button" aria-label="Move right">
                            <span class="btn-icon">→</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Load the main script using Vite's entry point -->
    <script type="module" src="/src/js/main.js"></script>
    
    <script>
        // Create animated stars in the background
        document.addEventListener('DOMContentLoaded', function() {
            const bgStars = document.getElementById('bg-stars');
            
            // Create 100 stars
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                const size = Math.random() * 3 + 1;
                const opacity = Math.random() * 0.7 + 0.3;
                
                star.style.position = 'absolute';
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.backgroundColor = 'white';
                star.style.borderRadius = '50%';
                star.style.opacity = opacity;
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.boxShadow = '0 0 ' + (size*2) + 'px rgba(255, 255, 255, 0.8)';
                
                // Add subtle animation
                star.style.animation = 'twinkle ' + (Math.random() * 3 + 2) + 's infinite alternate';
                
                bgStars.appendChild(star);
            }
        });
    </script>
    
    <script>
        // Touch controls layout management
        document.addEventListener('DOMContentLoaded', function() {
            const standardLayout = document.getElementById('standard-layout');
            const tabletLayout = document.getElementById('tablet-layout');
            const leftyLayout = document.getElementById('lefty-layout');
            
            // Use localStorage to remember user's layout preference
            let savedLayout = localStorage.getItem('controlLayout');
            
            // Set layout based on saved preference or device
            function setLayout() {
                // Check if it's a tablet (based on screen size)
                const isTablet = window.innerWidth >= 600 && window.innerWidth <= 1024;
                
                // If device is tablet and no preference saved, set tablet layout as default
                if (isTablet && !savedLayout) {
                    savedLayout = 'tablet';
                    localStorage.setItem('controlLayout', 'tablet');
                }
                
                // If no preference set, default to standard
                if (!savedLayout) {
                    savedLayout = 'standard';
                    localStorage.setItem('controlLayout', 'standard');
                }
                
                // Apply the layout
                standardLayout.style.display = 'none';
                tabletLayout.style.display = 'none';
                leftyLayout.style.display = 'none';
                
                if (savedLayout === 'standard') {
                    standardLayout.style.display = 'block';
                } else if (savedLayout === 'tablet') {
                    tabletLayout.style.display = 'flex';
                } else if (savedLayout === 'lefty') {
                    leftyLayout.style.display = 'block';
                }
            }
            
            setLayout();
            
            // Switch layout on screen orientation change
            window.addEventListener('resize', function() {
                const isTablet = window.innerWidth >= 600 && window.innerWidth <= 1024;
                
                // Only change layout if there was no previously saved preference
                if (isTablet && (!localStorage.getItem('controlLayout') || localStorage.getItem('controlLayout') === 'standard')) {
                    localStorage.setItem('controlLayout', 'tablet');
                    setLayout();
                } else if (!isTablet && localStorage.getItem('controlLayout') === 'tablet') {
                    localStorage.setItem('controlLayout', 'standard');
                    setLayout();
                }
            });
            
            // Connect alternative layout buttons to the same functions as the standard buttons
            function setupAltButtons() {
                // Get all button references
                const buttons = {
                    jump: [document.getElementById('jumpBtn'), document.getElementById('jumpBtn-alt'), document.getElementById('jumpBtn-left')],
                    left: [document.getElementById('leftBtn'), document.getElementById('leftBtn-alt'), document.getElementById('leftBtn-left')],
                    right: [document.getElementById('rightBtn'), document.getElementById('rightBtn-alt'), document.getElementById('rightBtn-left')],
                    dig: [document.getElementById('digBtn'), document.getElementById('digBtn-alt'), document.getElementById('digBtn-left')]
                };
                
                // Function to dispatch an event to the original button
                function mirrorTouch(originalBtn, eventType) {
                    if (originalBtn) {
                        const event = new Event(eventType);
                        originalBtn.dispatchEvent(event);
                    }
                }
                
                // For each control type (jump, left, right, dig)
                for (const [action, btns] of Object.entries(buttons)) {
                    const primaryBtn = btns[0];
                    
                    // Skip if primary button not found
                    if (!primaryBtn) continue;
                    
                    // Set up alternative buttons to mirror primary button events
                    for (let i = 1; i < btns.length; i++) {
                        if (btns[i]) {
                            ['touchstart', 'touchend', 'mousedown', 'mouseup', 'mouseleave'].forEach(eventType => {
                                btns[i].addEventListener(eventType, () => mirrorTouch(primaryBtn, eventType));
                            });
                        }
                    }
                }
            }
            
            // Set up the alternative buttons after a short delay to ensure DOM is fully loaded
            setTimeout(setupAltButtons, 500);
        });
    </script>
</body>
</html> 